(()=>{const e="../../backEnd/php/";document.addEventListener("DOMContentLoaded",(function(){var t=document.getElementById("calendar"),n=new FullCalendar.Calendar(t,{locale:"es",firstDay:1,initialView:"dayGridMonth",headerToolbar:!1,events:e+"cargar_eventos.php",height:"auto",datesSet:function(e){document.getElementById("currentMonthYear").innerHTML=`<h4>${e.view.title}</h4>`},eventContent:function(e){var t=document.createElement("div");t.classList.add("fc-event-time");var n=new Date(e.event.start).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),d=new Date(e.event.end).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});t.innerHTML=n+" - "+d,t.style.color="black";var o=document.createElement("div");o.classList.add("fc-event-title"),o.innerHTML=e.event.title,o.style.color=e.textColor;var i=document.createElement("div");return i.appendChild(t),i.appendChild(o),{domNodes:[i]}},slotDuration:"01:00:00",eventClick:function(e){var t=e.event;document.getElementById("eventId").value=t.id,document.getElementById("editTitulo").value=t.title,document.getElementById("editDescription").value=t.extendedProps.description,document.getElementById("editStart").value=t.start.toISOString().slice(0,16),document.getElementById("editEnd").value=t.end.toISOString().slice(0,16),document.getElementById("editColor").value=t.backgroundColor,document.getElementById("editTextColor").value=t.textColor,$("#editEventModal").modal("show")}});function d(){var e=document.getElementById("sidebarMenu");e.classList.contains("open")&&e.classList.remove("open")}n.render(),document.getElementById("btnPrev").addEventListener("click",(function(){n.prev()})),document.getElementById("btnToday").addEventListener("click",(function(){n.today()})),document.getElementById("btnNext").addEventListener("click",(function(){n.next()})),document.getElementById("btnMonth").addEventListener("click",(function(){n.changeView("dayGridMonth"),d()})),document.getElementById("btnMonth2").addEventListener("click",(function(){n.changeView("dayGridMonth"),d()})),document.getElementById("btnWeek").addEventListener("click",(function(){n.changeView("timeGridWeek"),d()})),document.getElementById("btnWeek2").addEventListener("click",(function(){n.changeView("timeGridWeek"),d()})),document.getElementById("btnDay").addEventListener("click",(function(){n.changeView("timeGridDay"),d()})),document.getElementById("btnDay2").addEventListener("click",(function(){n.changeView("timeGridDay"),d()})),document.getElementById("toggleMenu").addEventListener("click",(function(){document.getElementById("sidebarMenu").classList.toggle("open")})),document.getElementById("addEventBtn").addEventListener("click",(function(){$("#eventModal").modal("show")})),document.getElementById("createEventForm").addEventListener("submit",(function(t){t.preventDefault();const d=document.getElementById("eventTitle").value,o=document.getElementById("eventDescription").value,i=document.getElementById("eventStart").value,a=document.getElementById("eventEnd").value,l=document.getElementById("eventColor").value,r=document.getElementById("eventTextColor").value,c=localStorage.getItem("id"),m=new FormData;m.append("titulo",d),m.append("descripcion",o),m.append("inicio",i),m.append("fin",a),m.append("color",l),m.append("textColor",r),m.append("idProfe",c),fetch(e+"crear_evento.php",{method:"POST",body:m}).then((e=>e.json())).then((e=>{if(!e.success)throw new Error(e.message);$("#eventModal").modal("hide"),n.refetchEvents()})).catch((e=>{console.error("Error:",e),alert("Error al crear el evento: "+e.message)}))})),document.getElementById("editEventForm").addEventListener("submit",(function(t){t.preventDefault();const d=document.getElementById("eventId").value,o=document.getElementById("editTitulo").value,i=document.getElementById("editDescription").value,a=document.getElementById("editStart").value,l=document.getElementById("editEnd").value,r=document.getElementById("editColor").value,c=document.getElementById("editTextColor").value,m=new FormData;m.append("id",d),m.append("titulo",o),m.append("descripcion",i),m.append("inicio",a),m.append("fin",l),m.append("color",r),m.append("textColor",c),fetch(e+"actualizar_evento.php",{method:"POST",body:m}).then((e=>e.json())).then((e=>{if(!e.success)throw new Error(e.message||"Error al actualizar el evento");$("#editEventModal").modal("hide"),n.refetchEvents()})).catch((e=>{console.error("Error al actualizar el evento:",e),alert("Error al actualizar el evento: "+e.message)}))})),document.getElementById("deleteEventButton").addEventListener("click",(function(){const t=document.getElementById("eventId").value;confirm("¿Estás seguro de que deseas eliminar este evento?")&&fetch(e+"eliminar_evento.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`id=${t}`}).then((e=>e.json())).then((e=>{if(!e.success)throw new Error(e.message||"Error al eliminar el evento");$("#editEventModal").modal("hide"),n.refetchEvents()})).catch((e=>{console.error("Error al eliminar el evento:",e),alert("Error al eliminar el evento: "+e.message)}))}))}))})();