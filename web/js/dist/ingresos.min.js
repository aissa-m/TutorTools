(()=>{const t="../../backEnd/php/";function n(t){const n={};return t.forEach((t=>{const e=function(t){const n=t.split("-");return["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][parseInt(n[1],10)-1]}(t.fecha.substring(0,7));n[e]||(n[e]={total:0,ingresos:[]}),n[e].ingresos.push(t),n[e].total+=parseFloat(t.monto)})),n}document.addEventListener("DOMContentLoaded",(function(){!function(){const e=localStorage.getItem("id");fetch(t+"ingresos.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}).then((t=>t.json())).then((t=>{const e=document.getElementById("acordeon-ingresos");if(e.innerHTML="","No hay datos"===t)document.getElementById("titulo").innerText="No hay datos todavía!";else{const o=n(t);Object.keys(o).forEach(((t,n)=>{const a=`\n            <div class="card" style="background-color: rgba(0, 0, 0, 0.2);">\n              <div class="card-header" id="heading${n}">\n                <h2 class="mb-0">\n                  <button class="btn btn-link btn-block text-left " type="button" data-toggle="collapse" data-target="#collapse${n}" aria-expanded="true" aria-controls="collapse${n}" style="color: black;">\n                    ${t} - Total: ${o[t].total.toFixed(2)}€\n                  </button>\n                </h2>\n              </div>\n              <div id="collapse${n}" class="collapse" aria-labelledby="heading${n}" data-parent="#acordeon-ingresos">\n\n              <div class="card-body">\n                ${o[t].ingresos.map((t=>`\n                      <div class="card mb-3" style="background-color: rgba(0, 0, 0, 0.2);">\n                        <div class="card-body">\n                          <h5 class="card-title">${t.nombre}</h5>\n                          <p class="card-text">Monto: ${t.monto}€</p>\n                          <p class="card-text">Fecha: ${t.fecha}</p>\n                          <button class="btn btn-secondary eliminar" data-id="${t.id}" data-tipo="ingreso">Eliminar</button>\n                        </div>\n                      </div>\n                    `)).join("")}\n              </div>\n\n            </div>            \n              </div>\n            </div>\n          `;e.insertAdjacentHTML("beforeend",a)}))}})).catch((t=>{console.error(t)}))}(),fetch(t+"getStudents_back.php").then((t=>t.json())).then((t=>{if(t.success){const n=document.getElementById("alumnoSelect");t.alumnos.forEach((t=>{const e=document.createElement("option");e.value=t.id,e.textContent=t.nombre,n.appendChild(e)}))}})).catch((t=>console.error("Error:",t))),document.getElementById("formAgregarIngreso").addEventListener("submit",(function(n){n.preventDefault();var e=new FormData(this);fetch(t+"setIngreso.php",{method:"POST",body:e}).then((t=>t.json())).then((t=>{"Exito"===t&&(location.href="ingresos.html")})).catch((t=>{}))}))}))})();